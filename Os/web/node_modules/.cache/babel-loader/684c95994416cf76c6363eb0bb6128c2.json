{"ast":null,"code":"import \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.array.slice.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport API from '../../../utils/request';\nvar url = \"/api/good/\";\nexport default {\n  name: \"Goods\",\n  data: function data() {\n    return {\n      baseApi: this.$store.state.baseApi,\n      fileList: [],\n      options: [],\n      searchText: '',\n      user: {},\n      tableData: [],\n      pageNum: 1,\n      pageSize: 5,\n      entity: {},\n      total: 0,\n      dialogFormVisible: false\n    };\n  },\n  created: function created() {\n    this.user = localStorage.getItem(\"user\") ? JSON.parse(localStorage.getItem(\"user\")) : {};\n    this.load();\n  },\n  methods: {\n    handleSecKill: function handleSecKill(row) {\n      // 如果是秒杀商品\n      if (row.isSecKill === true) {\n        if (confirm('确定将此商品设为秒杀商品吗？')) {\n          var seckillPrice = prompt('请输入秒杀价格：');\n\n          if (seckillPrice !== null) {\n            // 用户点击确定并且输入了秒杀价格\n            this.setSecKill(row, parseFloat(seckillPrice));\n          }\n        }\n      } else {\n        this.setNotSecKill(row, parseFloat('0'));\n      }\n    },\n    setSecKill: function setSecKill(row, seckillPrice) {\n      var _this = this;\n\n      var data = {\n        id: row.id,\n        isSecKill: 1,\n        seckillPrice: seckillPrice\n      }; // 使用POST请求\n\n      API.post(url + 'setseckill?isSecKill=' + data.isSecKill, data).then(function (res) {\n        if (res.code === '200') {\n          _this.$message.success('设置秒杀商品成功'); // 更新商品列表或重新加载数据\n\n\n          _this.loadData();\n        } else {\n          _this.$message.error(res.msg);\n        }\n      });\n    },\n    setNotSecKill: function setNotSecKill(row, seckillPrice) {\n      var _this2 = this;\n\n      var data = {\n        id: row.id,\n        isSecKill: 0,\n        seckillPrice: seckillPrice\n      }; // 使用POST请求\n\n      API.post(url + 'setseckill?isSecKill=' + data.isSecKill, data).then(function (res) {\n        if (res.code === '200') {\n          _this2.$message.success('取消秒杀商品成功'); // 更新商品列表或重新加载数据\n\n\n          _this2.loadData();\n        } else {\n          _this2.$message.error(res.msg);\n        }\n      });\n    },\n    handleSizeChange: function handleSizeChange(pageSize) {\n      this.pageSize = pageSize;\n      this.load();\n    },\n    handleCurrentChange: function handleCurrentChange(pageNum) {\n      this.pageNum = pageNum;\n      this.load();\n    },\n    handleRecommend: function handleRecommend(good) {\n      var _this3 = this;\n\n      API.get(url + \"recommend\", {\n        params: {\n          id: good.id,\n          isRecommend: good.recommend\n        }\n      }).then(function (res) {\n        if (res.code === '200') {\n          _this3.$message.success(\"修改成功\");\n        } else {\n          _this3.$message.error(res.msg);\n        }\n      });\n    },\n    load: function load() {\n      var _this4 = this;\n\n      API.get(url + \"fullPage\", {\n        params: {\n          pageNum: this.pageNum,\n          pageSize: this.pageSize,\n          searchText: this.searchText\n        }\n      }).then(function (res) {\n        _this4.tableData = res.data.records;\n        _this4.total = res.data.total; // 在获取数据后对每一行商品的isSecKill属性进行判断并设置开关状态\n\n        _this4.tableData.forEach(function (item) {\n          item.isSecKill === 1 ? item.isSecKill = true : item.isSecKill = false;\n        });\n      });\n    },\n    reset: function reset() {\n      this.searchText = '';\n      this.load();\n    },\n    add: function add() {\n      // this.entity = {}\n      // this.fileList = []\n      // this.dialogFormVisible = true\n      this.$router.push(\"goodInfo\");\n    },\n    edit: function edit(obj) {\n      this.entity = JSON.parse(JSON.stringify(obj));\n      this.$router.push({\n        name: 'goodInfo',\n        query: {\n          good: JSON.stringify(this.entity)\n        }\n      });\n    },\n    handleImgSuccess: function handleImgSuccess(res) {\n      var _this5 = this;\n\n      this.entity.imgs = res.data;\n      API.post(url, this.entity).then(function (res2) {\n        if (res2.code === '200') {\n          _this5.$message({\n            type: \"success\",\n            message: \"操作成功\"\n          });\n        } else {\n          _this5.$message({\n            type: \"error\",\n            message: res2.msg\n          });\n        }\n\n        _this5.load();\n\n        _this5.dialogFormVisible = false;\n      });\n    },\n    save: function save() {\n      var _this6 = this;\n\n      console.log(this.fileList); //上传图片\n\n      if (this.fileList.length !== 0) {\n        console.log('上传中');\n        this.$refs.upload.submit();\n      } else {\n        //不上传图片\n        console.log(this.entity);\n        API.post(url, this.entity).then(function (res2) {\n          if (res2.code === '200') {\n            _this6.$message({\n              type: \"success\",\n              message: \"操作成功\"\n            });\n          } else {\n            _this6.$message({\n              type: \"error\",\n              message: res2.msg\n            });\n          }\n\n          _this6.load();\n\n          _this6.dialogFormVisible = false;\n        });\n      }\n    },\n    del: function del(id) {\n      var _this7 = this;\n\n      API.delete(url + id).then(function (res) {\n        _this7.$message({\n          type: \"success\",\n          message: \"操作成功\"\n        });\n\n        _this7.load();\n      });\n    },\n    handleChange: function handleChange(file, fileList) {\n      this.fileList = fileList.slice(-3);\n    }\n  }\n};","map":{"version":3,"mappings":"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","names":["name","data","baseApi","fileList","options","searchText","user","tableData","pageNum","pageSize","entity","total","dialogFormVisible","created","methods","handleSecKill","row","setSecKill","seckillPrice","id","isSecKill","API","then","setNotSecKill","handleSizeChange","handleCurrentChange","handleRecommend","good","params","isRecommend","load","item","reset","add","edit","obj","query","handleImgSuccess","res","type","message","save","console","del","handleChange","file"],"sourceRoot":"src/views/manage/good","sources":["Goods.vue"],"sourcesContent":["  <template>\r\n    <div>\r\n      <div style=\"padding: 5px 0\">\r\n        <el-input v-model=\"searchText\" @keyup.enter.native=\"load\" style=\"width: 200px\"> <i slot=\"prefix\" class=\"el-input__icon el-icon-a-042\"></i></el-input>\r\n        <el-button @click=\"load\" type=\"primary\" style=\"margin: 5px\">\r\n          <i class=\"el-icon-a-042\"></i>\r\n          搜索\r\n        </el-button>\r\n        <el-button @click=\"reset\" type=\"warning\" style=\"margin: 5px\">\r\n          <i class=\"el-icon-a-031\"></i>\r\n          重置\r\n        </el-button>\r\n        <el-button @click=\"add\" type=\"success\" style=\"margin: 5px\">\r\n          <i class=\"el-icon-a-07\"></i>\r\n          新增\r\n        </el-button>\r\n      </div>\r\n\r\n      <el-table :data=\"tableData\" border stripe style=\"width: 100%\">\r\n        <el-table-column prop=\"id\" label=\"商品id\" width=\"80px\"></el-table-column>\r\n        <el-table-column prop=\"name\" label=\"商品名称\"></el-table-column>\r\n        <el-table-column label=\"商品图片\" width=\"120px\">\r\n          <template slot-scope=\"scope\">\r\n            <img :src=\"baseApi + scope.row.imgs\" style=\"width: 90px;height: 80px\">\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"description\" label=\"商品描述\"></el-table-column>\r\n        <el-table-column prop=\"discount\" label=\"折扣\"></el-table-column>\r\n        <el-table-column prop=\"sales\" label=\"销量\"></el-table-column>\r\n        <el-table-column prop=\"saleMoney\" label=\"销售额（元)\"></el-table-column>\r\n        <el-table-column prop=\"createTime\" label=\"创建时间\">\r\n          <template slot-scope=\"scope\">\r\n            {{scope.row.createTime.replace(\" \",\"&nbsp;&nbsp;\")}}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"推荐\" width=\"150\" >\r\n          <!--      推荐商品-->\r\n          <template slot-scope=\"scope\">\r\n            <el-switch\r\n                v-model=\"scope.row.recommend\"\r\n                @change=\"handleRecommend(scope.row)\"\r\n                active-color=\"#13ce66\"\r\n                inactive-color=\"#ff4949\">\r\n            </el-switch>\r\n          </template>\r\n        </el-table-column>\r\n\r\n  <!--      设为秒杀商品-->\r\n        <el-table-column label=\"秒杀商品\" width=\"150\" >\r\n        <template slot-scope=\"scope\">\r\n          <el-switch\r\n              v-model=\"scope.row.isSecKill\"\r\n              @change=\"handleSecKill(scope.row)\"\r\n              active-color=\"#13ce66\"\r\n              inactive-color=\"#ff4949\">\r\n          </el-switch>\r\n        </template>\r\n      </el-table-column>\r\n\r\n\r\n\r\n        <el-table-column\r\n            fixed=\"right\"\r\n            label=\"操作\"\r\n            width=\"250\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button type=\"primary\" icon=\"el-icon-a-032\" style=\"font-size: 18px;\" circle  @click=\"edit(scope.row)\"></el-button>\r\n            <el-popconfirm\r\n                @confirm=\"del(scope.row.id)\"\r\n                title=\"确定删除？\"\r\n            >\r\n              <el-button type=\"danger\" icon=\"el-icon-a-022\" circle slot=\"reference\" style=\"font-size: 18px;margin-left: 10px\"></el-button>\r\n            </el-popconfirm>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <div style=\"margin-top: 10px\">\r\n        <el-pagination\r\n          @size-change=\"handleSizeChange\"\r\n          @current-change=\"handleCurrentChange\"\r\n          :current-page=\"pageNum\"\r\n          :page-size=\"pageSize\"\r\n          :page-sizes=\"[3, 5, 8, 10]\"\r\n          layout=\"total, sizes, prev, pager, next, jumper\"\r\n          :total=\"total\"\r\n        >\r\n        </el-pagination>\r\n      </div>\r\n\r\n      <!-- 弹窗   -->\r\n      <el-dialog title=\"信息\" :visible.sync=\"dialogFormVisible\" width=\"30%\"\r\n                 :close-on-click-modal=\"false\">\r\n        <el-form :model=\"entity\">\r\n          <el-form-item label=\"商品名称\" label-width=\"150px\">\r\n            <el-input v-model=\"entity.name\" autocomplete=\"off\" style=\"width: 80%\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"商品描述\" label-width=\"150px\">\r\n            <el-input v-model=\"entity.description\" autocomplete=\"off\" style=\"width: 80%\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"折扣\" label-width=\"150px\">\r\n            <el-input v-model=\"entity.discount\" autocomplete=\"off\" style=\"width: 80%\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"分类id\" label-width=\"150px\">\r\n            <el-input v-model=\"entity.categoryId\" autocomplete=\"off\" style=\"width: 80%\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"商品图片\" label-width=\"150px\">\r\n            <el-upload\r\n                class=\"upload-demo\"\r\n                ref=\"upload\"\r\n                :action=\"baseApi + '/file/upload'\"\r\n                :file-list=\"fileList\"\r\n                :on-change=\"handleChange\"\r\n                :limit=\"2\"\r\n                :on-success=\"handleImgSuccess\"\r\n                :auto-upload=\"false\">\r\n              <el-button slot=\"trigger\" size=\"small\" type=\"primary\">选取文件</el-button>\r\n              <div slot=\"tip\" class=\"el-upload__tip\">只能上传jpg/png文件，且不超过500kb</div>\r\n            </el-upload>\r\n          </el-form-item>\r\n        </el-form>\r\n        <div slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\r\n          <el-button type=\"primary\" @click=\"save\">确 定</el-button>\r\n        </div>\r\n      </el-dialog>\r\n    </div>\r\n  </template>\r\n\r\n  <script>\r\n  import API from '../../../utils/request'\r\n  const url = \"/api/good/\"\r\n\r\n  export default {\r\n    name: \"Goods\",\r\n    data() {\r\n      return {\r\n        baseApi: this.$store.state.baseApi,\r\n        fileList: [],\r\n        options: [],\r\n        searchText: '',\r\n        user: {},\r\n        tableData: [],\r\n        pageNum: 1,\r\n        pageSize: 5,\r\n        entity: {},\r\n        total: 0,\r\n        dialogFormVisible: false\r\n      };\r\n    },\r\n    created() {\r\n      this.user = localStorage.getItem(\"user\") ? JSON.parse(localStorage.getItem(\"user\")) : {}\r\n      this.load()\r\n\r\n    },\r\n    methods: {\r\n      handleSecKill(row) {\r\n          // 如果是秒杀商品\r\n        if(row.isSecKill === true)\r\n        {\r\n          if (confirm('确定将此商品设为秒杀商品吗？')) {\r\n            const seckillPrice = prompt('请输入秒杀价格：');\r\n            if (seckillPrice !== null) {\r\n              // 用户点击确定并且输入了秒杀价格\r\n              this.setSecKill(row, parseFloat(seckillPrice));\r\n            }\r\n          }\r\n        }\r\n        else {\r\n          this.setNotSecKill(row, parseFloat('0'));\r\n        }\r\n\r\n      },\r\n      setSecKill(row, seckillPrice) {\r\n        const data = {\r\n          id: row.id,\r\n          isSecKill: 1,\r\n          seckillPrice: seckillPrice\r\n        };\r\n\r\n        // 使用POST请求\r\n        API.post(url + 'setseckill?isSecKill='+data.isSecKill, data)\r\n            .then(res => {\r\n              if (res.code === '200') {\r\n                this.$message.success('设置秒杀商品成功');\r\n                // 更新商品列表或重新加载数据\r\n                this.loadData();\r\n              } else {\r\n                this.$message.error(res.msg);\r\n              }\r\n            })\r\n\r\n      },\r\n      setNotSecKill(row, seckillPrice) {\r\n        const data = {\r\n          id: row.id,\r\n          isSecKill: 0,\r\n          seckillPrice: seckillPrice\r\n        };\r\n\r\n        // 使用POST请求\r\n        API.post(url + 'setseckill?isSecKill='+data.isSecKill, data)\r\n            .then(res => {\r\n              if (res.code === '200') {\r\n                this.$message.success('取消秒杀商品成功');\r\n                // 更新商品列表或重新加载数据\r\n                this.loadData();\r\n              } else {\r\n                this.$message.error(res.msg);\r\n              }\r\n            })\r\n\r\n      },\r\n      handleSizeChange(pageSize) {\r\n        this.pageSize = pageSize\r\n        this.load()\r\n      },\r\n      handleCurrentChange(pageNum) {\r\n        this.pageNum = pageNum\r\n        this.load()\r\n      },\r\n      handleRecommend(good){\r\n        API.get(url + \"recommend\", {\r\n          params: {\r\n            id: good.id,\r\n            isRecommend : good.recommend,\r\n          }\r\n        }).then(res => {\r\n          if(res.code==='200'){\r\n            this.$message.success(\"修改成功\")\r\n          }else{\r\n            this.$message.error(res.msg)\r\n          }\r\n        })\r\n      },\r\n      load() {\r\n         API.get(url + \"fullPage\", {\r\n            params: {\r\n              pageNum: this.pageNum,\r\n              pageSize: this.pageSize,\r\n              searchText: this.searchText\r\n            }\r\n         }).then(res => {\r\n            this.tableData = res.data.records\r\n            this.total = res.data.total\r\n            // 在获取数据后对每一行商品的isSecKill属性进行判断并设置开关状态\r\n            this.tableData.forEach(item => {item.isSecKill === 1 ? (item.isSecKill = true) : (item.isSecKill = false);\r\n           });\r\n         })\r\n      },\r\n      reset(){\r\n        this.searchText = '';\r\n        this.load()\r\n      },\r\n      add() {\r\n        // this.entity = {}\r\n        // this.fileList = []\r\n        // this.dialogFormVisible = true\r\n        this.$router.push(\"goodInfo\")\r\n      },\r\n      edit(obj) {\r\n        this.entity = JSON.parse(JSON.stringify(obj))\r\n        this.$router.push({name: 'goodInfo',query:{good: JSON.stringify(this.entity)}})\r\n      },\r\n      handleImgSuccess(res){\r\n        this.entity.imgs = res.data;\r\n        API.post(url, this.entity).then(res2 => {\r\n          if (res2.code === '200') {\r\n            this.$message({\r\n              type: \"success\",\r\n              message: \"操作成功\"\r\n            })\r\n          } else {\r\n            this.$message({\r\n              type: \"error\",\r\n              message: res2.msg\r\n            })\r\n          }\r\n          this.load()\r\n          this.dialogFormVisible = false\r\n        })\r\n      },\r\n      save() {\r\n        console.log(this.fileList)\r\n        //上传图片\r\n        if(this.fileList.length!==0){\r\n          console.log('上传中')\r\n          this.$refs.upload.submit();\r\n        }else{\r\n          //不上传图片\r\n          console.log(this.entity)\r\n          API.post(url, this.entity).then(res2 => {\r\n            if (res2.code === '200') {\r\n              this.$message({\r\n                type: \"success\",\r\n                message: \"操作成功\"\r\n              })\r\n            } else {\r\n              this.$message({\r\n                type: \"error\",\r\n                message: res2.msg\r\n              })\r\n            }\r\n            this.load()\r\n            this.dialogFormVisible = false\r\n          })\r\n        }\r\n      },\r\n      del(id) {\r\n        API.delete(url + id).then(res => {\r\n          this.$message({\r\n            type: \"success\",\r\n            message: \"操作成功\"\r\n          })\r\n          this.load()\r\n        })\r\n      },\r\n      handleChange(file, fileList){\r\n        this.fileList = fileList.slice(-3);\r\n      },\r\n\r\n    }\r\n\r\n  };\r\n  </script>\r\n\r\n  <style scoped>\r\n  </style>\r\n"]},"metadata":{},"sourceType":"module"}